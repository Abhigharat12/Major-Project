<!-- Fuse.js for live search -->
<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
<style>
  .buttonlogo {
    background: linear-gradient(to right, #0fa3ed, #3413c5);
    border: none;
    color: white;
    padding: 0.6rem 1.2rem;
    font-size: 1rem;
    font-weight: bold;
    border-radius: 30px;
    display: flex;
    align-items: center;
    gap: 0.6rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    transition: background 0.3s ease;
  }

  .buttonlogo:hover {
    background: linear-gradient(to right, #193ae0, #08c7d4);
  }

  .svgIcon {
    width: 1.2em;
    height: 1.2em;
    transition: transform 0.5s ease;
  }

  .buttonlogo:hover .svgIcon {
    transform: rotate(180deg);
  }
</style>




<nav class="navbar navbar-expand-md bg-light border-bottom sticky-top shadow-sm">
  <div class="container-fluid">
    <!-- Brand -->
  
<a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="/">
  <button class="buttonlogo">
    <svg class="svgIcon" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
      <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm50.7-186.9L162.4 380.6c-19.4 7.5-38.5-11.6-31-31l55.5-144.3c3.3-8.5 9.9-15.1 18.4-18.4l144.3-55.5c19.4-7.5 38.5 11.6 31 31L325.1 306.7c-3.2 8.5-9.9 15.1-18.4 18.4zM288 256a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/>
    </svg>
    Feel-Alive
  </button>
</a>



    <!-- Toggle button for mobile -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNavbar">
      <!-- Always visible links -->
      <ul class="navbar-nav me-auto mb-2 mb-md-0 d-flex align-items-center">

        <!-- Home -->
        <li class="nav-item me-2">
          <a href="/" class="button nav-link d-flex align-items-center gap-2 <%= currentRoute === '/' ? 'active fw-semibold text-primary' : '' %>">
            <video muted playsinline class="home-video-icon" id="homeIcon">
              <source src="/videos/house-twirl-selected.webm" type="video/webm" />
            </video>
            Home
          </a>
        </li>

        <!-- Listings -->
        <li class="nav-item me-2">
          <a href="/listings" class="button nav-link d-flex align-items-center gap-2 <%= currentRoute === '/listings' ? 'active fw-semibold text-primary' : '' %>">
            <video muted playsinline class="listings-video-icon" id="listingsIcon">
              <source src="/videos/balloon-twirl-selected.webm" type="video/webm" />
            </video>
            All Listings
          </a>
        </li>

        <!-- Add Listing -->
        <% if (currentUser) { %>
          <li class="nav-item me-2">
            <a href="/listings/new" class="button nav-link <%= currentRoute === '/listings/new' ? 'active fw-semibold text-primary' : '' %>">
              Add New Listing
            </a>
          </li>
        <% } %>

      </ul>

      <!-- Search Bar (only on home/listing pages) -->
      <% if (currentRoute === '/' || currentRoute === '/listings') { %>
      <form class="d-flex align-items-center me-3" onsubmit="return false;">
        <input class="form-control me-2" id="searchInput" type="search"
          placeholder="Search listings..." aria-label="Search">
        <button type="submit" class="searchbtn" id="searchBtn">
          <div id="glow">
            <div class="circle"></div>
            <div class="circle"></div>
          </div>
          <div id="container-stars">
            <div id="stars"></div>
          </div>
          <strong>SEARCH</strong>
        </button>
      </form>
      <% } %>

      <!-- User Dropdown (responsive) -->
<ul class="navbar-nav d-flex align-items-center gap-2">
  <% if (currentUser) { %>
    <!-- Display Username -->
    <li class="nav-item">
      <div class="user-profile small-btn">
        <div class="user-profile-inner">
          <p><%= currentUser.username || "User" %></p>
        </div>
      </div>
    </li>

    <!-- Logout Button -->
    <li class="nav-item">
      <form action="/auth/logout" method="POST">
        <button type="submit" class="user-profile small-btn logout-btn">
          <div class="user-profile-inner">
            <svg xmlns="http://www.w3.org/2000/svg" height="16" viewBox="0 0 24 24" width="16">
              <path fill="currentColor" d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-9v2h9v14h-9v2h9c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
            </svg>
            <p>Logout</p>
          </div>
        </button>
      </form>
    </li>
  <% } else { %>
    <!-- Login Button -->
    <li class="nav-item me-1">
      <a href="/auth/login" class="neon-btn">
  <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="white">
    <path d="M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4 8 5.79 8 8s1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
  </svg>
  Log In
</a>

    </li>

    <!-- Sign Up Button -->
    <li class="nav-item">
      <a href="/auth/signup" class="neon-btn">
  <svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" fill="white" viewBox="0 0 24 24">
    <path d="M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4s-4 1.79-4 4 1.79 4 4 4zm-2 2h4c2.67 0 8 1.34 8 4v2H2v-2c0-2.66 5.33-4 8-4z"/>
  </svg>
  Sign Up
</a>

    </li>
  <% } %>
</ul>

    </div>
  </div>
</nav>

<!-- Play video icons once on load -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const icons = [document.getElementById("homeIcon"), document.getElementById("listingsIcon")];
    icons.forEach(icon => {
      if (!icon) return;
      icon.play();
      icon.addEventListener("ended", () => {
        icon.currentTime = 0;
        icon.pause();
      });
      icon.addEventListener("click", () => {
        icon.play();
      });
    });
  });
</script>
